
Here we send a CL of 6 in order to go through the frontend, and when it gets to the back the chunk protocol will stay waiting for the second part, that is the way you realize that is a CL TE server
![[Pasted image 20250905234634.png]]

For the attack we need to create a payload where there is another request that throws 404, in order to do this first we send a request with CL 41 (35 if we use the lab request, but it does not care if you leave the automatic correction), and when the request gets the backend it will be treat as a chunked package, so it is going to read 0 and then the rest is going to be smuggle to the next request. 
We need to pay attention to do not leave space after the last "X".

![[Pasted image 20250905234714.png]]

```
POST / HTTP/1.1 Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 35
Transfer-Encoding: chunked 
0 
GET /404 HTTP/1.1 X-Ignore: X
```

This is how should look the request. We can leave the content length automatic in this lab does not care. I we should get a 200, and then send a normal request and get a 404
![[Pasted image 20250908210506.png]]
![[Pasted image 20250908210630.png]]

